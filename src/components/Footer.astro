---
import { labels } from "../data/presentation";

const labelsDE = labels.de.footer;
const labelsEN = labels.en.footer;
---

<footer class="py-12 border-t border-[var(--ctp-surface1)]">
  <div class="max-w-5xl mx-auto px-4 sm:px-6">
    <div class="text-center">
      <p class="font-mono text-sm text-[var(--ctp-subtext0)]">
        Benjamin Fink ·
        <span
          data-i18n="footer-label"
          data-de={labelsDE.label}
          data-en={labelsEN.label}
        >
          {labelsDE.label}
        </span>
        · {new Date().getFullYear()}
      </p>
    </div>
  </div>
</footer>

<script>
  function initFooterI18n() {
    const STORAGE_KEY = "presentation-language";

    function getLanguage(): "de" | "en" {
      const stored = localStorage.getItem(STORAGE_KEY);
      return stored === "en" ? "en" : "de";
    }

    function updateContent(lang: "de" | "en") {
      document.querySelectorAll("[data-i18n='footer-label']").forEach((el) => {
        const text = el.getAttribute(`data-${lang}`);
        if (text) el.textContent = text;
      });
    }

    // Initialize
    updateContent(getLanguage());

    // Listen for language changes
    window.addEventListener("languageChange", (e: Event) => {
      const detail = (e as CustomEvent).detail;
      if (detail?.language) {
        updateContent(detail.language);
      }
    });
  }

  initFooterI18n();
  document.addEventListener("astro:after-swap", initFooterI18n);
</script>
